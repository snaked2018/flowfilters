class SHTPopup extends SHTCustomComponent{constructor(){super(),this.sticky_popup=SHTHelper.qs("sht-sticky-popup"),this.properties=JSON.parse(this.dataset.props),this.myStorage=window.sessionStorage,this.sessionStorageName=Shopify.theme.name.toLowerCase()+"-popup-display",this.cartNotification=SHTHelper.qs("sht-cart-noti"),this.isOpen=!1,this.buffer=100,this.myScrollHeight=document.body.scrollHeight||SHTHelper.qde.scrollHeight||0,this.myWindowHeight=window.innerHeight||SHTHelper.qde.clientHeight||0,this.elms={close_btn:this.$(".js-popup-close-btn"),body:SHTHelper.qs("body")},this.triggerOn=this.properties.triggerOn,this.scrollEventHandle=this.onScrollEventHandle.bind(this),this.onLoadUserAction=this.onUserAction.bind(this),this.bindEventHandlers()}bindEventHandlers(){this.elms.close_btn.addEventListener("click",this.onCloseBtnClickHandle.bind(this)),window.addEventListener("scroll",this.scrollEventHandle),this.cartNotification&&"after-closing-cart-notification"===this.triggerOn&&this.cartNotification.addEventListener("closed",t=>{this.getPopupStatus()||this.togglePopup(!0)}),["mouseover"].forEach(function(t){SHTHelper.qs("body").addEventListener(t,this.onLoadUserAction)}.bind(this)),this.popupAttrObserve()}onUserAction(t){this.classList.contains("d-none")&&this.classList.remove("d-none"),t.currentTarget.removeEventListener(t.type,this.onLoadUserAction)}onScrollEventHandle(t){var e,s;"reaching-to-footer"!==this.triggerOn?window.removeEventListener("scroll",this.scrollEventHandle):(this.myScrollHeight=document.body.scrollHeight||SHTHelper.qde.scrollHeight||0,e=(window.pageYOffset||SHTHelper.qde.scrollTop||document.body.scrollTop||0)+this.buffer+this.myWindowHeight>=this.myScrollHeight,s=this.getPopupStatus(),"reaching-to-footer"!==this.triggerOn||!e||null!==this.getAttribute("open")&&""!==this.getAttribute("open")||s||this.togglePopup(!0))}togglePopup(t){t?(this.toggleOpen(!0),this.properties.showSticky&&this.sticky_popup&&this.sticky_popup.removeStickyPopupStatus()):(this.toggleOpen(!1),this.setPopupStatus())}toggleOpen(t){t?(this.style.setProperty("--height",this.clientHeight+"px"),this.elms.body.classList.add("is-popup-show"),this.setAttribute("open",!0)):(this.elms.body.classList.remove("is-popup-show"),this.removeAttribute("open"),SHTHelper.removeTrapFocus())}onCloseBtnClickHandle(t){t.preventDefault(),this.properties.showSticky&&this.sticky_popup&&(this.sticky_popup.getStickyPopupStatus()||this.sticky_popup.openStickyPopup()),this.togglePopup(!1)}setPopupStatus(){this.myStorage.setItem(this.sessionStorageName,!1)}getPopupStatus(){return Shopify.designMode?"":this.myStorage.getItem(this.sessionStorageName)}popupAttrObserve(){new MutationObserver((t,e)=>{t.forEach(async t=>{"open"==t.attributeName&&(this.hasAttribute("open")?(await this.animationsComplete(),this.dispatchEvent(new Event("opened")),SHTHelper.trapFocus(this)):(SHTHelper.removeTrapFocus(),await this.animationsComplete(),this.dispatchEvent(new Event("closed"))))})}).observe(this,{attributes:!0})}animationsComplete(){return Promise.allSettled(this.getAnimations().map(t=>t.finished))}removePopupStatus(){this.myStorage.removeItem(this.sessionStorageName)}}customElements.define("sht-popup",SHTPopup);class SHTStickyPopup extends SHTCustomComponent{constructor(){super(),this.myStorage=window.sessionStorage,this.popup=SHTHelper.qs("sht-popup"),this.sessionStickyStorageName=Shopify.theme.name.toLowerCase()+"-sticky-popup-display",this.elms={close_btn:this.$(".js-sticky-popup-close-btn"),open_popup_btn:this.$(".js-sticky-popup-reopen-btn")},this.max_height=0,this.init(),this.bindEventHandlers()}init(){var t=this.getStickyPopupStatus(),e=this.popup.getPopupStatus();null==t&&"false"==e&&this.openStickyPopup()}removeStickyPopupStatus(){this.myStorage.removeItem(this.sessionStickyStorageName)}bindEventHandlers(){this.elms.close_btn.addEventListener("click",this.onCloseBtnClickHandle.bind(this)),this.elms.open_popup_btn.addEventListener("click",this.onOpenPopupBtnClickHandle.bind(this))}onOpenPopupBtnClickHandle(t){t.preventDefault(),this.popup.removePopupStatus(),this.popup.togglePopup(!0),this.hideStickyPopup()}onCloseBtnClickHandle(t){t.preventDefault(),this.closeStickyPopup()}setStickyPopupStatus(){this.myStorage.setItem(this.sessionStickyStorageName,!1)}getStickyPopupStatus(){return Shopify.designMode?"":this.myStorage.getItem(this.sessionStickyStorageName)}closeStickyPopup(){this.classList.add("popup-sticky-hide"),this.setStickyPopupStatus()}hideStickyPopup(){this.classList.add("popup-sticky-hide")}openStickyPopup(){this.style.setProperty("--height",this.clientHeight+"px"),this.style.setProperty("--width",this.clientWidth+"px"),this.classList.remove("popup-sticky-hide")}}customElements.define("sht-sticky-popup",SHTStickyPopup);